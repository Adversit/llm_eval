# LLM 评估平台 - 启动说明

## 📁 可用的启动脚本

项目根目录下有 4 个 `.bat` 启动脚本：

| 脚本 | 用途 | 推荐场景 |
|------|------|----------|
| `start.bat` | 开发模式 (React界面) | 日常开发调试 |
| `start_production.bat` | 生产模式 (React界面) | 运行评估任务 |
| `stop.bat` | 停止所有服务 | 关闭服务 |
| `start_streamlit.bat` | 旧版界面 (Streamlit) | 可选的备用界面 |

---

## 📁 启动脚本详细说明

### 1. `start.bat` - 开发模式 (推荐日常使用)
```bash
双击运行: start.bat
```

**特点:**
- ✅ 支持热重载 (`--reload`)
- ✅ 修改代码后自动重启
- ✅ 适合开发调试
- ⚠️ **不适合长时间运行的评估任务** (代码变动会中断任务)

**使用场景:**
- 日常开发调试
- 前端界面调整
- 快速测试功能

---

### 2. `start_production.bat` - 生产模式 (推荐运行评估任务)
```bash
双击运行: start_production.bat
```

**特点:**
- ✅ 稳定运行，不会自动重启
- ✅ 适合长时间运行的评估任务
- ✅ 避免任务中断 (`asyncio.CancelledError`)
- ⚠️ 修改代码需手动重启服务

**使用场景:**
- 运行评估任务
- 演示系统功能
- 生产环境部署

---

### 3. `stop.bat` - 停止所有服务
```bash
双击运行: stop.bat
```

**功能:**
- 🛑 停止后端服务 (端口 8000)
- 🛑 停止前端服务 (端口 3000)
- 🧹 清理所有相关进程

---

### 4. `start_streamlit.bat` - 旧版界面 (可选)
```bash
双击运行: start_streamlit.bat
```

**特点:**
- 🔄 使用 Streamlit 框架的旧版界面
- 📊 功能可能与 React 版本不同
- ⚠️ 不推荐日常使用

**使用场景:**
- 需要使用旧版界面的特定功能
- 备用界面选项

**推荐:**
- 💡 优先使用 `start.bat` 或 `start_production.bat` (React 新版界面)

---

## 🔧 代理配置说明

### 自动适配网络环境

系统已升级为**智能代理检测**，无需手动配置：

✅ **有代理的环境** (如当前电脑)
- 系统自动检测 `HTTPS_PROXY` 环境变量
- 自动使用代理访问 API
- 无需修改任何配置

✅ **无代理的环境** (如演示电脑)
- 系统检测到无代理设置
- 直接连接 API
- 无需修改任何配置

**相关文件:**
- `LLM_EVAL/utils/eval_llm.py` - 评估模型调用
- `LLM_EVAL/utils/test_LLM.py` - 测试模型调用

---

## 🚀 快速开始

### 第一次启动
1. 双击 `start_production.bat` (生产模式)
2. 等待服务启动 (约 3-5 秒)
3. 浏览器访问: http://localhost:3000

### 运行评估任务
1. 确保使用 `start_production.bat` 启动
2. 在前端界面创建评估任务
3. 等待任务完成 (不要关闭后端窗口)

### 开发调试
1. 双击 `start.bat` (开发模式)
2. 修改代码后自动重启
3. 刷新浏览器查看效果

### 停止服务
1. 双击 `stop.bat`
2. 或者关闭后端和前端的命令行窗口

---

## 📊 服务访问地址

| 服务 | 地址 | 说明 |
|------|------|------|
| 前端界面 | http://localhost:3000 | React 应用 |
| 后端 API | http://localhost:8000 | FastAPI 服务 |
| API 文档 | http://localhost:8000/api/docs | Swagger 文档 |

---

## ❓ 常见问题

### Q1: 启动失败，提示端口被占用
**解决方法:**
1. 运行 `stop.bat` 停止所有服务
2. 重新运行启动脚本

### Q2: 评估任务运行到一半中断了
**原因:** 使用了开发模式 (`start.bat`)，代码变动触发了服务重启

**解决方法:**
1. 使用 `start_production.bat` 启动
2. 运行任务期间不要关闭后端窗口

### Q3: API 连接失败 (SSL 错误)
**原因:** 代理配置问题 (已修复)

**验证修复:**
1. 检查是否使用最新代码
2. 重启后端服务
3. 查看评估结果的 `llm_answer` 字段是否正常

### Q4: 后端窗口没有日志输出
**说明:** 日志会在后端命令行窗口中实时显示

**查看日志:**
- 找到标题为 "LLM-Backend" 的命令行窗口
- 如果窗口被关闭，日志将丢失

---

## 🎯 推荐工作流程

### 日常开发
```
1. start.bat (开发模式)
2. 修改代码
3. 浏览器刷新查看效果
4. stop.bat (结束工作)
```

### 运行评估
```
1. start_production.bat (生产模式)
2. 创建评估任务
3. 等待任务完成
4. 查看结果
5. stop.bat (结束任务)
```

### 系统演示
```
1. start_production.bat (生产模式)
2. 打开浏览器展示功能
3. stop.bat (演示结束)
```
